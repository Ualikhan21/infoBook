<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>infoBook</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      background-color: #f8f9fa;
    }
    #header {
      padding: 15px 25px;
      background: #2c3e50;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    #header h1 {
      margin: 0;
      font-size: 24px;
      color: #ecf0f1;
      font-weight: 600;
    }
    .search-box{
      width: fit-content;
      height: fit-content;
      position: relative;
    }
    .input-search{
      height: 30px;
      width: 200px;
      border-style: none;
      padding: 10px;
      font-size: 18px;
      letter-spacing: 2px;
      outline: none;
      border-radius: 25px;
      transition: all .5s ease-in-out;
      background-color: #4e647a;
      padding-right: 40px;
      color:#fff;
    }
    .input-search::placeholder{
      text-align: center;
      color:rgba(255,255,255,.5);
      font-size: 18px;
      letter-spacing: 2px;
      font-weight: 100;
    }
    .btn-search{
      width: 50px;
      height: 50px;
      border-style: none;
      font-size: 20px;
      font-weight: bold;
      outline: none;
      cursor: pointer;
      border-radius: 50%;
      position: absolute;
      right: 0px;
      color:#ffffff ;
      background-color:transparent;
      pointer-events: painted;  
    }
    .btn-search:focus ~ .input-search{
      width: 300px;
      border-radius: 0px;
      background-color: transparent;
      border-bottom:1px solid rgba(255,255,255,.5);
      transition: all 500ms cubic-bezier(0, 0.110, 0.35, 2);
    }
    .input-search:focus{
      width: 300px;
      border-radius: 0px;
      background-color: transparent;
      border-bottom:1px solid rgba(255,255,255,.5);
      transition: all 500ms cubic-bezier(0, 0.110, 0.35, 2);
    }
    .search-results {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      background: #2c3e50;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      max-height: 240px;
      overflow-y: auto;
      z-index: 1000;
      width: 350px;
      display: none;
      color: #ffffff;
      font-family: 'Segoe UI', sans-serif;
      font-size: 16px;
      padding-top: 8px 0;
    }

    .search-results div {
      padding: 10px 16px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .search-results div:hover {
      background-color: #ffffff30;
    }
    #map-container {
      display: flex;
      flex: 1;
      margin: 15px;
      gap: 20px;
    }
    #map {
      flex: 3;
      height: 100%;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      border: 1px solid #ddd;
    }
    #sidebar {
      flex: 1;
      padding: 25px;
      background: #ffffff;
      overflow-y: auto;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      min-width: 320px;
      transition: all 0.3s ease;
    }
    .language-toggles {
      display: flex;
      gap: 10px;
    }
    .language-toggle {
      padding: 8px 16px;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.2s ease;
      font-size: 14px;
    }
    .language-toggle:hover {
      background: #2980b9;
      transform: translateY(-1px);
    }
    .language-toggle.active {
      background: #e74c3c;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .custom-svg-icon {
      background: transparent !important;
      border: none !important;
      filter: drop-shadow(0 3px 5px rgba(0,0,0,0.3));
    }
    .book-info {
      margin-top: 20px;
      font-size: 16px;
      line-height: 1.7;
      color: #34495e;
    }
    .book-info h2 {
      color: #2c3e50;
      margin-bottom: 15px;
      font-size: 24px;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
    }
    .hidden {
      display: none;
    }
    #no-selection {
      color: #7f8c8d;
      font-style: italic;
      text-align: center;
      margin-top: 50px;
      font-size: 18px;
    }
    .leaflet-container {
      background: #ecf0f1 !important;
    }
  </style>
</head>
<body>
  <div id="header">
    <h1>infoBook</h1>
    <div class="search-box">
      <button class="btn-search"><i class="fas fa-search"></i></button>
      <input type="text" class="input-search" id="search-input" placeholder="Пойск">
      <div id="search-results" class="search-results"></div>
    </div>
    <div class="language-toggles">
      <button class="language-toggle active" id="lang-ru">РУС</button>
      <button class="language-toggle" id="lang-kz">ҚАЗ</button>
      <button class="language-toggle" id="lang-en">ENG</button>
    </div>
  </div>
  
  <div id="map-container">
    <div id="map"></div>
    <div id="sidebar">
      <div id="no-selection">Выберите место на карте</div>
      <div id="place-info" class="book-info hidden">
        <h2 id="info-title"></h2>
        <p id="info-content"></p>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const data = {
      ru: {
        places: [
          {
            coords: [51.12389, 71.38422],
            title: "Сыганак",
            content: "Улица Сыганак — одна из улиц столицы, носящая историческое название. Она названа в честь одного из древнейших и крупнейших городов на берегу Сырдарьи — Сыганака. Первые упоминания об этом городе относятся к X веку. В XI веке Махмуд Кашгари упоминает его как один из городов огузов. В XIII–XVI веках Сыганак был известен как международный и местный торговый центр. В город прибывали караваны из таких городов, как Мавераннахр, Кашгар, Туркестан. В XIV веке он стал столицей Ак Орды и достиг расцвета при хане Ерзене. В Сыганаке строились мечети, медресе и жилые дома. В XV–XVI веках город был важным административным и военным центром Казахского ханства. Сыганак, бывший столицей нескольких государств, является великим историческим наследием."
          },
          {
            coords: [51.129389, 71.386422],
            title: "ааа Улица",
            content: ""
          }
        ],
        noSelection: "Выберите место на карте",
        searchInput: "Пойск"
      },
      kz: {
        places: [
        {
            coords: [51.129389, 71.386422],
            title: "Сығанақ көшесі",
            content: "Сығанақ көшесі — елордадағы тарихи атауға ие көшелердің бірі. Оның атауы Сыр бойындағы ежелгі әрі ірі қалалардың бірі — Сығанақтың құрметіне қойылған. Бұл қала жайлы алғашқы деректер Х ғасырда кездеседі. XI ғасырда Махмұт Қашқари оны оғыз қалаларының бірі ретінде атап өтеді. XIII-XVI ғасырларда Сығанақ халықаралық және жергілікті сауда орталығы ретінде танымал болды. Қалаға Мауереннахр, Қашқар, Түркістан секілді қалалардан керуендер келіп тұрған. XIV ғасырда Ақ Орданың астанасына айналды, ал Ерзен хан тұсында гүлдене түсті. Қалада мешіт-медреселер, тұрғын үйлер салынды. XV-XVI ғасырларда Сығанақ Қазақ хандығының маңызды әкімшілік және әскери тірек орталығы болды. Өзінің тарихында бірнеше мемлекетке астана болған Сығанақ — ұлы тарихи мұра."
          },
        ],
        noSelection: "Картадан орынды таңдаңыз",
        searchInput: "Іздеу"
      },
      en: {
        places: [
        {
            coords: [51.129389, 71.386422],
            title: "Street Syganak",
            content: "Syganak Street \nThis street is named after Syganak, an ancient city on the Syr Darya River, known since the 10th century. Mahmud al-Kashgari listed it as a major Oghuz city. It became a trade center between Central Asia and neighboring regions, and was the capital of the White Horde in the 14th century. During the Kazakh Khanate, it served as an important military and administrative hub."
          },
        ],
        noSelection: "Select a location on the map",
        searchInput: "Search"
      }
    };

    let currentLang = 'ru';
    const map = L.map('map').setView([51.1282, 71.4307], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    const bookIcon = L.divIcon({
      html: `
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24">
          <!-- Основная форма маркера -->
          <path fill="#e74c3c" d="M12 2C8.1 2 5 5.1 5 9c0 5 7 12 7 12s7-7 7-12c0-3.9-3.1-7-7-7z" 
                stroke="#c0392b" stroke-width="0.5"/>
          
          <!-- Книга (левая часть) -->
          <path fill="#f5f5f5" d="M11.8 4.9v10c-1.1-1.9-3.7-1.7-4.5-0.2l-0.1-9c0.4-1.9 4.2-2.2 4.7-0.8z" 
                stroke="#ddd" stroke-width="0.3"/>
                
          <!-- Книга (правая часть) -->
          <path fill="#f5f5f5" d="M12.2 4.9v10c1.1-1.9 3.7-1.7 4.5-0.2l0.1-9c-0.4-1.9-4.2-2.2-4.7-0.8z" 
                stroke="#ddd" stroke-width="0.3"/>
                
          <!-- Детализация корешка -->
          <path fill="#c0392b" d="M12 6l0.2-1h-0.4l0.2 1z" opacity="0.8"/>
        </svg>
      `,
      className: 'custom-svg-icon',
      iconSize: [56, 56],  
      iconAnchor: [28, 56],
      popupAnchor: [0, -56] 
    });

    let markers = [];
    let selectedMarker = null;
    
    function updateUI(lang) {
      document.getElementById('no-selection').textContent = data[lang].noSelection;
      document.getElementById('search-input').placeholder = data[lang].searchInput;
      
      document.querySelectorAll('.language-toggle').forEach(btn => {
        btn.classList.remove('active');
      });
      document.getElementById(`lang-${lang}`).classList.add('active');
      
      if (selectedMarker !== null) {
        const place = data[lang].places[selectedMarker];
        document.getElementById('info-title').textContent = place.title;
        document.getElementById('info-content').textContent = place.content;
      }
    }

    function updateMap(lang) {
      markers.forEach(marker => map.removeLayer(marker));
      markers = [];
      
      data[lang].places.forEach((place, index) => {
        const marker = L.marker(place.coords, { icon: bookIcon })
          .addTo(map)
          .on('click', () => {
            selectedMarker = index;
            document.getElementById('info-title').textContent = place.title;
            document.getElementById('info-content').textContent = place.content;
            document.getElementById('place-info').classList.remove('hidden');
            document.getElementById('no-selection').classList.add('hidden');
          });
        markers.push(marker);
      });
    }

      const searchInput = document.getElementById('search-input');
      const searchResults = document.getElementById('search-results');

      searchInput.addEventListener('input', function () {
        const query = this.value.toLowerCase();
        searchResults.innerHTML = '';

        markers.forEach(marker => map.removeLayer(marker));
        markers = [];
        selectedMarker = null;

        const matchingPlaces = data[currentLang].places
          .map((place, index) => ({ ...place, index }))
          .filter(item => item.title.toLowerCase().includes(query));

        if (query === '') {
          searchResults.style.display = 'none';
          updateMap(currentLang);
          return;
        }

        if (matchingPlaces.length === 0) {
          searchResults.style.display = 'block';
          searchResults.innerHTML = '<div style="padding:10px;color:#999;">Ничего не найдено</div>';
          return;
        }

        matchingPlaces.forEach(item => {
          const div = document.createElement('div');
          div.textContent = item.title;
          div.style.padding = '10px';
          div.style.cursor = 'pointer';
          div.style.borderBottom = '1px solid #eee';
          div.addEventListener('click', () => {
            map.setView(item.coords, 15);
            document.getElementById('info-title').textContent = item.title;
            document.getElementById('info-content').textContent = item.content;
            document.getElementById('place-info').classList.remove('hidden');
            document.getElementById('no-selection').classList.add('hidden');
            searchResults.style.display = 'none';
            searchInput.value = item.title;
          });
          searchResults.appendChild(div);

          const marker = L.marker(item.coords, { icon: bookIcon }).addTo(map).on('click', () => {
            document.getElementById('info-title').textContent = item.title;
            document.getElementById('info-content').textContent = item.content;
            document.getElementById('place-info').classList.remove('hidden');
            document.getElementById('no-selection').classList.add('hidden');
          });

          markers.push(marker);
        });

        searchResults.style.display = 'block';
      });


    document.addEventListener('click', (event) => {
      const isClickInside = document.querySelector('.search-box').contains(event.target);
      if (!isClickInside) {
        searchResults.style.display = 'none';
      }
    });

    document.getElementById('lang-ru').addEventListener('click', () => {
      currentLang = 'ru';
      updateUI(currentLang);
      updateMap(currentLang);
    });
    
    document.getElementById('lang-kz').addEventListener('click', () => {
      currentLang = 'kz';
      updateUI(currentLang);
      updateMap(currentLang);
    });
    
    document.getElementById('lang-en').addEventListener('click', () => {
      currentLang = 'en';
      updateUI(currentLang);
      updateMap(currentLang);
    });

  document.addEventListener("DOMContentLoaded", () => {
    updateUI(currentLang);
    updateMap(currentLang);
  });
  </script>
</body>
</html>